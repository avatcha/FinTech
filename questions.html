<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Healthcare Questionnaire</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --pad-x:24px; --stroke:#e5e9f2; --card:#fff; --text:#0a0f2c; --brand:#1a73e8; --brand-700:#0f5ad2; --soft:#f7f9ff; --muted:#6b7280; }
    * , *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body { font-family: 'Inter', sans-serif; background: #f7f9fc; color: var(--text); margin: 0; padding-top: 80px; }
    .stk-container { max-width: 1200px; margin: 0 auto; padding: 0 var(--pad-x); }
    .stk-header { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: rgba(255,255,255,0.9); border-bottom: 1px solid var(--stroke); backdrop-filter: blur(8px); }
    .stk-header-inner { display: flex; align-items: center; justify-content: space-between; min-height: 60px; }
    .stk-brand { color: var(--text); text-decoration: none; font-weight: 800; font-size: 20px; }
    .stk-nav { display: flex; gap: 18px; align-items: center; }
    .stk-nav a { color: inherit; text-decoration: none; font-weight: 600; font-size: 14px; }
    .stk-nav a:hover { text-decoration: underline; }
    .stk-toggle { display: none; border: 0; background: none; font-size: 26px; cursor: pointer; }
    @media (max-width: 820px) {
      .stk-toggle { display: block; }
      .stk-nav { display: none; position: absolute; right: var(--pad-x); top: 60px; background: var(--card); border: 1px solid var(--stroke); border-radius: 12px; box-shadow: 0 8px 24px rgba(2,6,23,.15); padding: 12px; }
      .stk-nav.open { display: block; }
      .stk-nav a { display: block; padding: 8px 10px; }
    }
    .stk-kicker { font-weight: 800; font-size: 12px; letter-spacing: .12em; text-transform: uppercase; color: var(--brand); margin: 10px 0 8px 0; }
    .stk-strip { display: flex; align-items: center; gap: 10px; background: var(--soft); border: 1px solid var(--stroke); border-radius: 12px; padding: 10px 12px; color: var(--muted); font-size: 13px; }
    .stk-strip svg { flex: 0 0 auto; }
    .wizard { background: white; width: 100%; max-width: 600px; margin: 24px auto; padding: 30px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid #e4e7ed; }
    h1 { margin-top: 0; }
    .step { display: none; }
    .active { display: block; }
    label { display: block; font-weight: 600; margin-bottom: 6px; }
    input, select, button { width: 100%; padding: 12px; margin-bottom: 16px; font-size: 16px; border-radius: 12px; border: 1px solid #d5d9e2; }
    button { background: #1a73e8; color: white; font-weight: 700; cursor: pointer; border: none; }
    button:hover { background: #0f5ad2; }
    .nav-buttons { display: flex; justify-content: space-between; gap: 12px; margin-top: 12px; }
    .small { font-size: 12px; color: var(--muted); }
    .badge { display:inline-block; padding:3px 8px; border-radius:999px; font-size:12px; margin-right:6px; background:#eef2ff; }
    .ok { background:#ecfdf5; color:#166534; }
    .warn { background:#fff7ed; color:#b45309; }
  </style>
</head>

<body>
  <header class="stk-header">
    <div class="stk-container stk-header-inner">
      <a class="stk-brand" href="index.html">stakxAi</a>
      <button class="stk-toggle">☰</button>
      <nav id="stk-primary-nav" class="stk-nav">
        <a href="retirement.html">Retirement Planning</a>
        <a href="budget/easy.html">Budget Tool</a>
        <a href="questions.html">Healthcare Tool</a>
        <a href="community.html">Community Boards</a>
      </nav>
    </div>
  </header>

  <div class="stk-container" style="margin-top:12px;">
    <div class="stk-kicker">Rack your Stakx.</div>
    <div class="stk-strip">
      <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 15h-2v-6h2Zm0-8h-2V7h2Z"/></svg>
      Free forever. No login required. No data is collected by us.
    </div>
  </div>

  <div class="wizard">
    <h1>Healthcare Questionnaire</h1>
    <p class="small">Answers are temporary and not saved.</p>

    <!-- STEP 1 -->
    <div class="step active" id="step1">
      <h2>Step 1: About You</h2>
      <label>Age</label>
      <input id="age" type="number" placeholder="e.g., 45" />
      <label>ZIP Code</label>
      <input id="zip" placeholder="12345" />
      <div id="zipErr" class="small" style="color:red; display:none;"></div>

      <div id="countyWrap" style="display:none;">
        <label>County</label>
        <select id="county"></select>
      </div>

      <div class="nav-buttons">
        <span></span>
        <button id="next1">Next</button>
      </div>
    </div>

    <!-- STEP 2 -->
    <div class="step" id="step2">
      <h2>Step 2: Coverage Status</h2>
      <label>Current Coverage</label>
      <select id="coverage">
        <option value="none">None</option>
        <option value="employer">Employer</option>
        <option value="medicare">Medicare</option>
        <option value="medicaid">Medicaid</option>
        <option value="cobra">COBRA</option>
      </select>
      <div class="nav-buttons">
        <button onclick="prevStep()">Back</button>
        <button onclick="nextStep()">Next</button>
      </div>
    </div>

    <!-- STEP 3 -->
    <div class="step" id="step3">
      <h2>Step 3: Household Info</h2>
      <label>Household Income</label>
      <input id="income" type="number" placeholder="e.g., 54000" />
      <label>Household Size</label>
      <input id="hhSize" type="number" placeholder="e.g., 2" />
      <div class="nav-buttons">
        <button onclick="prevStep()">Back</button>
        <button onclick="nextStep()">Next</button>
      </div>
    </div>

    <!-- STEP 4 -->
    <div class="step" id="step4">
      <h2>Step 4: Preferences</h2>
      <label>Preferred Pharmacy</label>
      <select id="pharmacy">
        <option value="preferred">Preferred retail</option>
        <option value="standard">Standard retail</option>
        <option value="mail">Mail order</option>
      </select>
      <label>Use prescription medications?</label>
      <select id="usesDrugs"><option value="no">No</option><option value="yes">Yes</option></select>
      <div class="nav-buttons">
        <button onclick="prevStep()">Back</button>
        <button onclick="nextStep()">Next</button>
      </div>
    </div>

    <!-- STEP 5 -->
    <div class="step" id="step5">
      <h2>Step 5: Medicare Details (if applicable)</h2>
      <label>Medicare Status</label>
      <select id="medicareStatus">
        <option value="none">Not enrolled</option>
        <option value="A_only">Part A only</option>
        <option value="B_only">Part B only</option>
        <option value="A_and_B">Parts A + B</option>
      </select>
      <label>Preferred Plan Style</label>
      <select id="planStylePref">
        <option value="ma">Medicare Advantage (C)</option>
        <option value="ab_medigap">A+B + Medigap + D</option>
      </select>
      <div id="medicareBadges" style="margin-top:6px;"></div>
      <div class="nav-buttons">
        <button onclick="prevStep()">Back</button>
        <button onclick="nextStep()">Next</button>
      </div>
    </div>

    <!-- STEP 6 -->
    <div class="step" id="step6">
      <h2>Step 6: All Set!</h2>
      <p>See plan suggestions based on your answers.</p>
      <button onclick="goToPlans()">See My Plans</button>
      <div class="nav-buttons">
        <button onclick="prevStep()">Back</button>
        <span></span>
      </div>
    </div>
  </div>

  <script>
    const state = {};
    let current = 1;

    // Header toggle
    document.querySelector('.stk-toggle').addEventListener('click',()=>{
      document.querySelector('.stk-nav').classList.toggle('open');
    });

    function showStep(n){
      document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
      document.getElementById("step"+n).classList.add("active");
    }
    function nextStep(){ if(current<6) current++; showStep(current);}
    function prevStep(){ if(current>1) current--; showStep(current); }

    // --- ZIP → County lookup ---
    function countiesForZip(zip){
      const map={
        "10001":["New York County"],
        "30301":["Fulton County"],
        "60601":["Cook County"],
        "90001":["Los Angeles County"],
        "73301":["Travis County"],
        "80112":["Arapahoe County","Douglas County"]
      };
      return map[zip]||[];
    }

    document.getElementById('zip').addEventListener('change', ()=>{
      const zip=document.getElementById('zip').value.trim();
      state.zip=zip;
      const err=document.getElementById('zipErr');
      const wrap=document.getElementById('countyWrap');
      const sel=document.getElementById('county');
      if(!/^\d{5}$/.test(zip)){err.textContent='Enter 5-digit ZIP';err.style.display='block';wrap.style.display='none';state.county="";return;}
      err.style.display='none';
      const list=countiesForZip(zip);
      if(list.length===1){sel.innerHTML=`<option>${list[0]}</option>`;wrap.style.display='none';state.county=list[0];return;}
      if(list.length>1){sel.innerHTML=list.map(c=>`<option>${c}</option>`).join('');wrap.style.display='block';sel.onchange=()=>state.county=sel.value;state.county=sel.value;return;}
      wrap.style.display='none';state.county="";
    });

    document.getElementById('next1').addEventListener('click',()=>{
      const zip=document.getElementById('zip').value.trim();
      const age=document.getElementById('age').value.trim();
      if(!/^\d{5}$/.test(zip)){document.getElementById('zipErr').style.display='block';return;}
      if(!age||Number(age)<0||Number(age)>120){alert("Enter valid age");return;}
      state.zip=zip;state.age=age;
      const wrap=document.getElementById('countyWrap');
      if(wrap.style.display!=='none'){state.county=document.getElementById('county').value;}
      current=2;showStep(current);
    });

    // --- Derived logic ---
    function fplLine(hh){const base=15590;return base+(hh-1)*5540;}
    function computeDerived(){
      const hh=Number(state.hhSize||0);
      const inc=Number(state.incomeAnnual||0);
      state.magi=inc;
      const fpl=fplLine(hh);
      state.fplPct=Math.round((state.magi/fpl)*100);
      state.subsidyEligible=state.fplPct>=100&&state.fplPct<=600;
      state.medicaidEligible=state.fplPct<138;

      const onMedicare=Number(state.age)>=65&&(state.medicareStatus==="A_only"||state.medicareStatus==="B_only"||state.medicareStatus==="A_and_B");
      if(onMedicare){
        if(state.magi>206000)state.irmaaBracket="High";
        else if(state.magi>103000)state.irmaaBracket="Medium";
        else state.irmaaBracket="Base";
        state.lisEligible=state.fplPct<=150;
      } else {state.irmaaBracket=null;state.lisEligible=false;}

      if(Number(state.age)>=65){
        state.route=state.planStylePref==="ab_medigap"?"AB_Medigap_D":"MA";
        if(state.medicaidEligible)state.route="DSNP";
      } else {
        if(state.medicaidEligible)state.route="medicaid_chip";
        else if(state.subsidyEligible)state.route="ACA_subsidized";
        else state.route="ACA_fullpay";
      }
    }

    function renderMedicareBadges(){
      const el=document.getElementById('medicareBadges');
      const onMedicare=Number(state.age)>=65&&(state.medicareStatus==="A_only"||state.medicareStatus==="B_only"||state.medicareStatus==="A_and_B");
      if(!onMedicare){el.innerHTML="";return;}
      computeDerived();
      const badges=[];
      if(state.irmaaBracket)badges.push(`<span class="badge warn">IRMAA: ${state.irmaaBracket}</span>`);
      if(state.lisEligible)badges.push(`<span class="badge ok">Extra Help (LIS)</span>`);
      if(state.medicaidEligible)badges.push(`<span class="badge ok">Dual-Eligible (D-SNP)</span>`);
      el.innerHTML=badges.join('');
    }

    document.getElementById('medicareStatus').addEventListener('change',e=>{
      state.medicareStatus=e.target.value;computeDerived();renderMedicareBadges();
    });
    document.getElementById('planStylePref').addEventListener('change',e=>{
      state.planStylePref=e.target.value;computeDerived();renderMedicareBadges();
    });

    function goToPlans(){
      state.coverage=document.getElementById('coverage').value;
      state.incomeAnnual=document.getElementById('income').value;
      state.hhSize=document.getElementById('hhSize').value;
      state.pharmacy=document.getElementById('pharmacy').value;
      state.usesDrugs=document.getElementById('usesDrugs').value;
      computeDerived();
      const q=new URLSearchParams(state).toString();
      window.location.href="plans.html?"+q;
    }
  </script>
</body>
</html>
